<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BOOOMERANGS: –ë—ã—Å—Ç—Ä—ã–π AI —á–∞—Ç</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #111;
      color: white;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }
    
    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1rem 2rem;
      background: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid rgba(255, 255, 255, 0.05);
      position: sticky;
      top: 0;
      z-index: 10;
    }
    
    .logo {
      font-size: 1.5rem;
      background: linear-gradient(45deg, #ff4b2b, #ff416c);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      font-weight: bold;
    }
    
    main {
      flex: 1;
      padding: 2rem;
      max-width: 1200px;
      margin: 0 auto;
      width: 100%;
    }
    
    /* –ß–∞—Ç */
    .chat {
      display: flex;
      flex-direction: column;
      height: calc(100vh - 180px);
      max-height: 800px;
      border-radius: 12px;
      overflow: hidden;
      background: rgba(255, 255, 255, 0.03);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .chat-messages {
      flex: 1;
      overflow-y: auto;
      padding: 1.5rem;
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
    }
    
    .message {
      max-width: 80%;
      padding: 1rem;
      border-radius: 12px;
      line-height: 1.5;
    }
    
    .message-user {
      align-self: flex-end;
      background: linear-gradient(45deg, #ff4b2b, #ff416c);
      border-bottom-right-radius: 0;
    }
    
    .message-ai {
      align-self: flex-start;
      background: rgba(255, 255, 255, 0.1);
      border-bottom-left-radius: 0;
    }
    
    .message p {
      margin-bottom: 0.5rem;
    }
    
    .message p:last-child {
      margin-bottom: 0;
    }
    
    .message-meta {
      font-size: 0.8rem;
      margin-top: 8px;
      opacity: 0.7;
    }
    
    .chat-input-container {
      padding: 1rem;
      background: rgba(0, 0, 0, 0.3);
    }
    
    .input-controls {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }
    
    .bottom-controls {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 1rem;
    }
    
    .chat-input {
      width: 100%;
      padding: 0.75rem 1rem;
      border-radius: 8px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      background: rgba(255, 255, 255, 0.05);
      color: white;
      font-size: 1rem;
      resize: none;
      min-height: 60px;
    }
    
    .chat-input:focus {
      outline: none;
      border-color: #ff416c;
    }
    
    .button {
      padding: 0.75rem 1.5rem;
      border: none;
      background: linear-gradient(45deg, #ff4b2b, #ff416c);
      color: white;
      font-size: 1rem;
      font-weight: bold;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s;
    }
    
    .button:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(255, 75, 43, 0.3);
    }
    
    .button:disabled {
      opacity: 0.5;
      transform: none;
      box-shadow: none;
      cursor: not-allowed;
    }
    
    .model-selector {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
    }
    
    .model-option {
      padding: 0.5rem 1rem;
      border-radius: 8px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      color: white;
      font-size: 0.9rem;
      cursor: pointer;
      transition: all 0.2s;
      flex: 1 0 auto;
      text-align: center;
    }
    
    .model-option:hover {
      background: rgba(255, 255, 255, 0.1);
      transform: translateY(-2px);
    }
    
    .model-option.selected {
      background: rgba(255, 75, 43, 0.3);
      border-color: rgba(255, 75, 43, 0.6);
    }
    
    .loading-indicator {
      display: inline-block;
      margin-left: 8px;
      width: 16px;
      height: 16px;
      border: 2px solid rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      border-top-color: #fff;
      animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
      to {
        transform: rotate(360deg);
      }
    }
    
    /* –ú–æ–±–∏–ª—å–Ω–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è */
    @media (max-width: 768px) {
      header {
        padding: 1rem;
      }
      
      main {
        padding: 1rem;
      }
      
      .message {
        max-width: 90%;
      }
      
      .model-selector {
        grid-template-columns: 1fr 1fr;
      }
      
      .bottom-controls {
        flex-direction: column;
      }
      
      .button {
        width: 100%;
      }
    }
    
    footer {
      padding: 1rem 2rem;
      text-align: center;
      font-size: 0.875rem;
      color: rgba(255, 255, 255, 0.5);
      border-top: 1px solid rgba(255, 255, 255, 0.05);
    }
  </style>
</head>
<body>
  <header>
    <div class="logo">üöÄ BOOOMERANGS Quick</div>
  </header>
  
  <main>
    <div class="chat">
      <div class="chat-messages" id="chat-messages">
        <div class="message message-ai">
          <p>–ü—Ä–∏–≤–µ—Ç! –Ø BOOOMERANGS AI –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç —Å –±—ã—Å—Ç—Ä—ã–º–∏ –æ—Ç–≤–µ—Ç–∞–º–∏. –Ø –∏—Å–ø–æ–ª—å–∑—É—é –Ω–∞–¥–µ–∂–Ω—ã–π —Ä–µ–∂–∏–º –æ—Ç–≤–µ—Ç–æ–≤ –±–µ–∑ —Å—Ç—Ä–∏–º–∏–Ω–≥–∞, –Ω–æ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ–º –º–µ–∂–¥—É –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞–º–∏.</p>
          <div class="message-meta">BOOOMERANGS AI</div>
        </div>
      </div>
      <div class="chat-input-container">
        <div class="input-controls">
          <textarea class="chat-input" id="chat-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." rows="2"></textarea>
          <div class="model-selector" id="model-selector">
            <div class="model-option selected" data-model="auto">Auto</div>
            <div class="model-option" data-model="DEMO">Demo</div>
            <div class="model-option" data-model="Qwen_Max">Qwen Max</div>
            <div class="model-option" data-model="Qwen_3">Qwen 3</div>
            <div class="model-option" data-model="You">You AI</div>
          </div>
          <div class="bottom-controls">
            <button class="button" id="send-message">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
          </div>
        </div>
      </div>
    </div>
  </main>
  
  <footer>
    <p>¬© 2025 BOOOMERANGS. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
  </footer>
  
  <script>
    // –≠–ª–µ–º–µ–Ω—Ç—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
    const chatMessages = document.getElementById('chat-messages');
    const chatInput = document.getElementById('chat-input');
    const sendMessageButton = document.getElementById('send-message');
    const modelOptions = document.querySelectorAll('.model-option');
    
    // –°–æ—Å—Ç–æ—è–Ω–∏–µ —á–∞—Ç–∞
    let isLoading = false;
    let selectedModel = 'auto';
    
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –º–æ–¥–µ–ª–∏
    modelOptions.forEach(option => {
      option.addEventListener('click', () => {
        // –£–±–∏—Ä–∞–µ–º –∫–ª–∞—Å—Å selected —É –≤—Å–µ—Ö –º–æ–¥–µ–ª–µ–π
        modelOptions.forEach(o => o.classList.remove('selected'));
        
        // –î–æ–±–∞–≤–ª—è–µ–º –∫–ª–∞—Å—Å selected –≤—ã–±—Ä–∞–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏
        option.classList.add('selected');
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é –º–æ–¥–µ–ª—å
        selectedModel = option.getAttribute('data-model');
        console.log(`–í—ã–±—Ä–∞–Ω–∞ –º–æ–¥–µ–ª—å: ${selectedModel}`);
      });
    });
    
    // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —á–∞—Ç
    function addMessage(text, isUser, meta = null) {
      const messageDiv = document.createElement('div');
      messageDiv.className = `message ${isUser ? 'message-user' : 'message-ai'}`;
      
      // –†–∞–∑–±–∏–≤–∞–µ–º —Ç–µ–∫—Å—Ç –Ω–∞ –∞–±–∑–∞—Ü—ã
      const paragraphs = text.split('\n').filter(p => p.trim() !== '');
      paragraphs.forEach(paragraph => {
        const p = document.createElement('p');
        p.textContent = paragraph;
        messageDiv.appendChild(p);
      });
      
      // –î–æ–±–∞–≤–ª—è–µ–º –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π AI
      if (!isUser && meta) {
        const metaDiv = document.createElement('div');
        metaDiv.className = 'message-meta';
        metaDiv.textContent = meta;
        messageDiv.appendChild(metaDiv);
      }
      
      chatMessages.appendChild(messageDiv);
      chatMessages.scrollTop = chatMessages.scrollHeight;
      
      return messageDiv;
    }
    
    // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ –∑–∞–≥—Ä—É–∑–∫–∏
    function addLoadingIndicator() {
      const messageDiv = document.createElement('div');
      messageDiv.className = 'message message-ai';
      messageDiv.id = 'loading-message';
      
      const text = document.createElement('p');
      text.textContent = '–î—É–º–∞—é';
      
      const loadingIndicator = document.createElement('span');
      loadingIndicator.className = 'loading-indicator';
      
      text.appendChild(loadingIndicator);
      messageDiv.appendChild(text);
      
      chatMessages.appendChild(messageDiv);
      chatMessages.scrollTop = chatMessages.scrollHeight;
      
      return messageDiv;
    }
    
    // –£–¥–∞–ª–µ–Ω–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ –∑–∞–≥—Ä—É–∑–∫–∏
    function removeLoadingIndicator() {
      const loadingMessage = document.getElementById('loading-message');
      if (loadingMessage) {
        chatMessages.removeChild(loadingMessage);
      }
    }
    
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è
    async function sendMessage() {
      const messageText = chatInput.value.trim();
      if (!messageText || isLoading) return;
      
      // –î–æ–±–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
      addMessage(messageText, true);
      
      // –û—á–∏—â–∞–µ–º –ø–æ–ª–µ –≤–≤–æ–¥–∞ –∏ –±–ª–æ–∫–∏—Ä—É–µ–º –µ–≥–æ –Ω–∞ –≤—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏
      chatInput.value = '';
      chatInput.disabled = true;
      sendMessageButton.disabled = true;
      isLoading = true;
      
      // –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
      addLoadingIndicator();
      
      try {
        // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –∫ API
        const response = await fetch('/api/python/chat/quick', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Connection': 'keep-alive'
          },
          body: JSON.stringify({
            message: messageText,
            provider: selectedModel === 'auto' ? null : selectedModel,
            timeout: 25000 // 25 —Å–µ–∫—É–Ω–¥ —Ç–∞–π–º–∞—É—Ç
          })
        });
        
        // –£–¥–∞–ª—è–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
        removeLoadingIndicator();
        
        if (!response.ok) {
          throw new Error(`–û—à–∏–±–∫–∞ API: ${response.status}`);
        }
        
        const data = await response.json();
        
        if (data.success) {
          // –§–æ—Ä–º–∏—Ä—É–µ–º –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
          const meta = `${data.provider || 'BOOOMERANGS AI'}${data.model ? ` ¬∑ ${data.model}` : ''}`;
          
          // –î–æ–±–∞–≤–ª—è–µ–º –æ—Ç–≤–µ—Ç AI
          addMessage(data.response, false, meta);
        } else {
          throw new Error(data.error || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞');
        }
      } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –∑–∞–ø—Ä–æ—Å–∞:', error);
        
        // –£–¥–∞–ª—è–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ –µ—Å–ª–∏ –æ–Ω –µ—â—ë –µ—Å—Ç—å
        removeLoadingIndicator();
        
        // –î–æ–±–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
        addMessage(`–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –æ—Ç–≤–µ—Ç–∞: ${error.message}. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.`, false, '–û—à–∏–±–∫–∞');
      } finally {
        // –†–∞–∑–±–ª–æ–∫–∏—Ä—É–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
        chatInput.disabled = false;
        sendMessageButton.disabled = false;
        isLoading = false;
        
        // –§–æ–∫—É—Å –Ω–∞ –ø–æ–ª–µ –≤–≤–æ–¥–∞
        chatInput.focus();
      }
    }
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏
    sendMessageButton.addEventListener('click', sendMessage);
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–∞–∂–∞—Ç–∏—è Enter
    chatInput.addEventListener('keydown', (e) => {
      if (e.key === 'Enter' && !e.shiftKey) {
        e.preventDefault();
        sendMessage();
      }
    });
    
    // –ù–∞—á–∞–ª—å–Ω—ã–π —Ñ–æ–∫—É—Å –Ω–∞ –ø–æ–ª–µ –≤–≤–æ–¥–∞
    chatInput.focus();
  </script>
</body>
</html>